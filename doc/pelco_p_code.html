<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" name="Author" content="Douglas Lau"/>
	<link href="protozoa.css" rel="stylesheet" type="text/css"/>
	<title>Pelco P Camera Control Code</title>
</head>

<body>
<h2>Pelco P Camera Control Code</h2>

<h3>Framing</h3>
<p>
	All messages are framed between an STX and ETX byte, followed by a
	checksum.
	The checksum is obtained by performing an XOR of all bytes between STX
	and ETX, inclusive.
</p>
<table>
<tr>
	<th>STX</th>
	<th>MESSAGE</th>
	<th>ETX</th>
	<th>XSUM</th>
</tr>
<tr>
	<td>A0</td>
	<td>XX .. YY</td>
	<td>AF</td>
	<td>ZZ</td>
</tr>
</table>

<h3>Direct Addressing</h3>

<p>
	Direct addressing can only be used for camera control packets.
	The receiver address can range from 1 - 254.
	The MESSAGE is 5 bytes:
</p>
<table>
<tr>
	<th>ADDRESS</th>
	<th>PACKET</th>
</tr>
<tr>
	<td>01 - FF</th>
	<td>WW XX YY ZZ</th>
</tr>
</table>


<h3>Camera Control Packet</h3>
<p>
	A camera control packet can be either a pan/tilt/lens command or an
	extended command.
	Each of these is 4 bytes long.
</p>
<p>
	Pan and tilt speed can range from 0 - 63.
</p>
<p>
	Commands sent to a camera remain active until another command is
	received. For example, a pan will not stop until a command is sent
	with pan speed of zero. There is a timeout function, but it is well
	over 30 seconds.
</p>

<table>
<tr>
	<th colspan='6'>BASIC PACKET BITS</th>
</tr>
<tr>
	<th colspan='2'>0-15 &mdash; FLAGS</th>
	<th>16-21</th>
	<th>22-23</th>
	<th>24-29</th>
	<th>30-31</th>
</tr>
<tr>
	<td>focus far</td>
	<th>00</th>
	<td rowspan='16'>Pan Speed (0-63)</td>
	<td rowspan='16'>Must be 0</td>
	<td rowspan='16'>Tilt Speed (0-63)</td>
	<td rowspan='16'>Must be 0</td>
</tr>
<tr>
	<td>focus near</td>
	<th>01</th>
</tr>
<tr>
	<td>iris open</td>
	<th>02</th>
</tr>
<tr>
	<td>iris close</td>
	<th>03</th>
</tr>
<tr>
	<td>camera on / off</td>
	<th>04</th>
</tr>
<tr>
	<td>autoscan on</td>
	<th>05</th>
</tr>
<tr>
	<td>camera on</td>
	<th>06</th>
</tr>
<tr>
	<td>must be 0</td>
	<th>07</th>
</tr>
<tr>
	<td>must be 0</td>
	<th>08</th>
</tr>
<tr>
	<td>pan right</td>
	<th>09</th>
</tr>
<tr>
	<td>pan left</td>
	<th>10</th>
</tr>
<tr>
	<td>tilt up</td>
	<th>11</th>
</tr>
<tr>
	<td>tilt down</td>
	<th>12</th>
</tr>
<tr>
	<td>zoom in</td>
	<th>13</th>
</tr>
<tr>
	<td>zoom out</td>
	<th>14</th>
</tr>
<tr>
	<td>must be 0</td>
	<th>15</th>
</tr>
</table>

<p>
	Bit 8 determines whether a control packet is basic (0) or extended (1).
</p>

<table id="extended">
<tr>
	<th rowspan='2'>EXTENDED<br/>FUNCTION</th>
	<th colspan='8'>PACKET BITS</th>
	<th colspan='2'>PARAMETERS</th>
</tr>
<tr>
	<th>0-7</th>
	<th>13</th>
	<th>12</th>
	<th>11</th>
	<th>10</th>
	<th>09</th>
	<th>08</th>
	<th>14-15</th>
	<th>BITS 24-31</th>
	<th>BITS 16-23</th>
</tr>
<tr>
	<td>store preset</td>
	<td rowspan='20'>Must be 0</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td rowspan='20'>Must be 0</td>
	<td>1 - 255</td>
	<td>0</td>
</tr>
<tr>
	<td>clear preset</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>1 - 255</td>
	<td>0</td>
</tr>
<tr>
	<td>recall preset</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>1 - 255</td>
	<td>0</td>
</tr>
<tr>
	<td>flip 180</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0x21</td>
	<td>0</td>
</tr>
<tr>
	<td>zero pan position</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0x22</td>
	<td>0</td>
</tr>
<tr>
	<td>set auxiliary</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1 - 8</td>
	<td>0</td>
</tr>
<tr>
	<td>clear auxiliary</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1 - 8</td>
	<td>0</td>
</tr>
<tr>
	<td>remote reset</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>set zone start</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1 - 8</td>
	<td>0</td>
</tr>
<tr>
	<td>set zone end</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1 - 8</td>
	<td>0</td>
</tr>
<tr>
	<td>write character</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>ASCII char</td>
	<td>0 - 28 (X pos)</td>
</tr>
<tr>
	<td>clear all characters</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>acknowledge alarm</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>alarm #</td>
	<td>0</td>
</tr>
<tr>
	<td>zone scan on</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>zone scan off</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>set pattern start</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>set pattern stop</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>run pattern</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
</tr>
<tr>
	<td>set zoom speed</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>0</td>
	<td>1</td>
	<td>0 - 3</td>
	<td>0</td>
</tr>
<tr>
	<td>set focus speed</td>
	<td>1</td>
	<td>0</td>
	<td>0</td>
	<td>1</td>
	<td>1</td>
	<td>1</td>
	<td>0 - 3</td>
	<td>0</td>
</tr>
</table>

<p class="all">
	Auxiliary functions:
</p>
<table>
<tr>
	<th>AUX</th>
	<th>FUNCTION</th>
</tr>
<tr>
	<td>0</td>
	<td>autoscan</td>
</tr>
<tr>
	<td>1</td>
	<td>wiper</td>
</tr>
</table>

<div>
<p>
	Some preset functions are overloaded for special camera functions.
</p>
<table>
<tr>
	<th>PRESET</th>
	<th>FUNCTION</th>
</tr>
<tr>
	<td>Recall 1</td>
	<td>Park</td>
</tr>
<tr>
	<td>Recall 33</td>
	<td>Flip (pan 180 degrees)</td>
</tr>
<tr>
	<td>Recall 34</td>
	<td>Home (pan to zero point)</td>
</tr>
<tr>
	<td>Recall 88 (21)</td>
	<td>IR filter IN</td>
</tr>
<tr>
	<td>Recall 89 (22)</td>
	<td>IR filter OUT</td>
</tr>
<tr>
	<td>Store 90-91 (23-24)</td>
	<td>Set manual limit stops</td>
</tr>
<tr>
	<td>Store 92 (25)</td>
	<td>Set left scan limit stop</td>
</tr>
<tr>
	<td>Store 93 (26)</td>
	<td>Set right scan limit stop</td>
</tr>
<tr>
	<td>Store 94</td>
	<td>Remote reset</td>
</tr>
<tr>
	<td>Store 95 (28)</td>
	<td>Enter camera on-screen menu</td>
</tr>
<tr>
	<td>Recall 96 (29)</td>
	<td>Stop scan</td>
</tr>
<tr>
	<td>Recall 97 (30)</td>
	<td>Begin random scan</td>
</tr>
<tr>
	<td>Recall 98 (31)</td>
	<td>Begin fram scan</td>
</tr>
<tr>
	<td>Recall 99 (32)</td>
	<td>Begin auto scan</td>
</tr>
</table>
</div>

<br/>

<p class="stamp">
	2014 Sep 9
</p>
</body>
</html>
